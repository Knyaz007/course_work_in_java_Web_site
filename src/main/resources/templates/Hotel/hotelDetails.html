<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title th:text="${hotel.name}"></title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    .room-card {
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      background-color: #f9f9f9;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }

    .room-card h4 {
      margin-top: 15px;
    }

    .room-photo {
      max-width: 200px;
      max-height: 150px;
      margin: 5px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    .comment-card {
      border-left: 5px solid #007bff;
      background-color: #f8f9fa;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 6px;
    }

    .btn-actions {
      margin-top: 15px;
    }

    .star-rating .fa {
      font-size: 1.2rem;
    }

    .hotel-header {
      margin-top: 20px;
      margin-bottom: 30px;
    }

    .divider {
      height: 2px;
      background-color: #ccc;
      margin: 30px 0;
    }

  </style>
</head>
<body>

<!-- Баннер и навбар -->
<iframe id="banner-frame" th:src="@{/banner}" width="100%" scrolling="no" style="border: none; display: block;"></iframe>
<iframe id="navbar-frame" th:src="@{/navbar}" width="100%" style="border: none; display: block;"></iframe>

<div class="container mt-4">

  <!-- Название отеля -->
 <style>
  .hotel-header {
    background-color: #f0f8ff;
    padding: 25px 30px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
    margin-bottom: 40px;
    border-left: 5px solid #007bff;
  }

  .hotel-header h2 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 15px;
    color: #2c3e50;
  }

  .hotel-header p {
    margin: 0;
    font-size: 1.1rem;
    color: #555;
  }

  .hotel-header i {
    margin-right: 8px;
    color: #007bff;
  }

  .d-flex {
  all: unset; /* сбросит почти все стили */
  display: -ms-flexbox !important;
  /* display: flex !important; */ /* если хочешь включить поддержку современных браузеров */
  flex-wrap: nowrap !important;
  justify-content: center !important;
}

</style>

<div class="hotel-header">
  <h2 th:text="${hotel.name}">Название отеля</h2>
  <p>
    <i class="fas fa-map-marker-alt"></i>
    <span th:text="${hotel.region + ', ' + hotel.city + ', ' + hotel.street + ', ' + hotel.house}">Адрес</span>
  </p>
</div>

  <!-- Информация о номерах -->
  <h3>Информация о номерах</h3>

  <div th:each="room : ${rooms}" class="room-card">
    <div class="d-flex justify-content-between">
      <div>
        <h4>Описание:</h4>
        <p th:text="${room.description}">Описание номера</p>

        <h5 class="mt-3">Цена:</h5>
        <p><span th:text="${room.price}">0</span> ₽</p>
      </div>

      <!-- Фотографии -->
      <div>
        <h5>Фотографии:</h5>
        <div class="d-flex flex-wrap">
          <img class="room-photo" th:each="photo : ${room.photos}" 
               th:src="@{'/uploads/hotel-' + ${hotel.id} + '/room-' + ${room.id} + '/' + ${photo}}"
               alt="Фото комнаты"/>
        </div>
      </div>
    </div>

    <!-- Кнопки действий -->
    <div class="btn-actions">
      <form th:if="${roles.contains('ROLE_ADMIN') or roles.contains('ROLE_USER')}" 
            th:action="@{/rooms/bookRoom}" method="post" class="d-inline">
        <input type="hidden" name="roomId" th:value="${room.id}" />
        <input type="hidden" name="hotelId" th:value="${hotel.id}" />
        <button type="submit" class="btn btn-success">Забронировать</button>
      </form>
          <div th:if="${!(roles.contains('ROLE_ADMIN') or roles.contains('ROLE_USER'))}">
                        <form th:action="@{/login}" method="get" class="d-inline">
                            <input type="hidden" name="redirect" th:value="${currentUrl}" />
                            <button type="submit" class="btn btn-outline-primary btn-sm">Войти для бронирования</button>
                        </form>
                    </div>

      <a  th:if="${roles.contains('ROLE_ADMIN')}"  th:href="@{'/rooms/edit/' + ${room.id}}" class="btn btn-primary ml-2">Редактировать</a>

      <form  th:if="${roles.contains('ROLE_ADMIN')}"  th:action="@{'/rooms/delete/' + ${room.id}}" method="post" class="d-inline ml-2"
            onsubmit="return confirm('Вы уверены, что хотите удалить эту комнату?');">
        <input type="hidden" name="_method" value="delete"/>
        <button type="submit" class="btn btn-danger">Удалить</button>
      </form>
    </div>
  </div>

  <a th:href="@{'/rooms/add'}" class="btn btn-success mb-4">Добавить комнату</a>

  <div class="divider"></div>

  <!-- Средняя оценка -->
 <!--  <h4>Средняя оценка:</h4>
  <p>
    <span th:if="${averageEvaluation != null}" th:text="${#numbers.formatDecimal(averageEvaluation, 1, 1)} + ' / 5.0'">0.0 / 5.0</span>
    <span th:if="${averageEvaluation == null}">Нет оценок</span>
  </p>

  <div class="star-rating mb-4" th:if="${averageEvaluation != null}">
    <span th:each="i : ${#numbers.sequence(1, 5)}">
      <i class="fa"
         th:classappend="${i <= averageEvaluation} ? 'fa-star text-warning' : 
                         (i - averageEvaluation < 1 ? 'fa-star-half-alt text-warning' : 'fa-star-o text-muted')"></i>
    </span>
  </div> -->

  <!-- Отзывы -->
<!--   <h4 class="mt-5">Отзывы об отеле</h4>
  <div th:each="comment : ${hotel.comments}" class="comment-card">
    <h5 th:text="${comment.client.name}">Имя клиента</h5>
    <p><strong>Комментарий:</strong> <span th:text="${comment.commentary}">Комментарий</span></p>
    <p><strong>Оценка:</strong> <span th:text="${comment.evaluation}">5</span></p>
  </div> -->

</div>

    <!-- Подвал  оjs влияет-->
<iframe id="footer-frame" th:src="@{/footer}" width="100%" style="border: none; display: block; margin-top: 40px;"></iframe>
<!-- JS скрипты -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.8/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="/public/js/scripts.js"></script>


<!-- Bootstrap JS -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
